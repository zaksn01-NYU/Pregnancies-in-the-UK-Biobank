# Maternal Mental Health and Obstetric Complications: Diagnostic, Medication, and Genetic Risk Pathways

# Overview
This is the complete code for the work entitled, *Maternal Mental Health and Obstetric Complications: Diagnostic, Medication, and Genetic Risk Pathways* to enable replication. 
Steps 1 and 2 identify pregnancy-related clinical codes in the UK Biobank (UKB) and cluster these codes into distinct pregnancy events. Each pregnancy is classified according to delivery, abortive, or unknown outcome. 
Steps 3-7 combine pregnancy events with psychiatric diagnoses, psychotropic medications, PRS scores, and additional demographic variables, followed by all respective statistical analyses.

# Required UK Biobank Data
To run this code, the following UKB resources must be downloaded:

## Database Tables  
-***hesin.csv*** – Hospital Episode Statistics (HES) inpatient core dataset  
-***hesin_diag.csv*** – HES inpatient diagnoses  
-***gp_clinical.csv*** – General Practitioner (GP) clinical events  
-***gp_scripts.csv*** – GP prescriptions  

## UKB clinical coding classification systems and mapping files 
-***all_lkps_maps_v4.xlsx*** – downloaded from https://biobank.ndph.ox.ac.uk/ukb/ukb/auxdata/primarycare_codings.zip

## Additional sociodemographic and clinical variables
-***pathways_additional_vars.txt*** – A .txt file included in this repository that specifies the UKB field names that correspond to requisite sociodemographic and clinical variables. This file can be uploaded directly to UKB RAP to download these variables through the Table Exporter app.  
-***pathways_additional_vars.csv*** – The output file generated by the UKB RAP after uploading pathways_additional_vars.txt. The output file should be exported with field titles, and not field names, for compatibility with the included scripts.

## PRS scores for psychiatric conditions
-***PRS_ANX.txt, PRS_BIPOL.txt, PRS_DEPR.txt, PRS_SCZ.txt*** – User-generated files that contains user-calculated PRS scores for anxiety, bipolar, depressive, and schizophrenia spectrum disorders, with columns titled ‘eid’ and ‘PRS_ANX’ / ‘PRS_BIPOL’ / ‘PRS_DEPR’ / ‘PRS_SCZ’. Details of how to calculate these scores can be found in the manuscript  
-***PRS_PrinicalComponents.txt*** – A user-generated file that contains the first ten user-calculated genetic principal components, with columns titled ‘eid’, ‘PC1’, ‘PC2’, …, ‘PC10’

## Consent withdrawal
-***withdrawn.csv*** – A user-generated file containing the most recent list of participants who have withdrawn consent for data use. This should be a single column named ‘eid’ 

# Directory Structure
For compatibility with the included scripts, all data should be organized into the following two folders:  
-***raw_UKB*** – contains all the UKB data files listed above  
-***processed*** – contains all newly generated/processed data created by the scripts  

.
.
. 
For questions or issues, please contact: nina.zaks@nyulangone.org

